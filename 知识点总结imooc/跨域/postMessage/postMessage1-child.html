<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>同域父子页面间通讯-子页面</title>
</head>
<body>
	<h1 class="header">page B</h1>

	<input type="text" id="inp" value="some contents..">
	<button onclick="send()">send</button>

	<script>
	// 在同域下直接使用window向上向下访问变量和函数；直接用浏览器打开本页面不算同域，启动服务才算同域
	window.addEventListener('message', function(ev) {
	    // if (ev.source !== window.parent) {return;}
	    var data = ev.data;
	    console.info('message from parent:', data);
	}, false);

	function send() {
	    var data = document.querySelector('#inp').value;
	    // window.postMessage(data, '*'); // 触发当前页面的message事件
	    parent.postMessage(data, '*'); // 触发父页面的message事件
	    // parent.postMessage(data, 'http://localhost:9011/'); // 若父页面的域名和指定的不一致，则postMessage失败
	}
	</script>
</body>
</html>